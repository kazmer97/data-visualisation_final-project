---
title: "Data Visualisation Final Project"
author: "Study Group 11: Nereid Kwok, Nisa Ozer, Lauren Wade, Thomas Giannetti-Fakhouri, Kazmer Nagy-Betegh, Chandrime Tolia"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: flatly
    highlight: zenburn
    number_sections: true
    toc: yes
    toc_float: yes
---


```{r libraries, include=FALSE}

library(skimr)
library(vroom)
library(tidyverse)
library(dplyr)
library(ggthemes)
library(gghighlight)
library(plotly)
library(patchwork)
library(countrycode)
```


```{r}
astronauts <- vroom('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-07-14/astronauts.csv')

launches <- vroom("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-15/launches.csv")

agencies <- vroom("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-15/agencies.csv")

mission_success <- vroom(here::here("data","Space_Corrected.csv"))
```

```{r}
skim(astronauts)
```


```{r}
skim(launches)
```


```{r}
skim(agencies)
```

```{r}
mission_success <- select(mission_success, -c(1,2))

state_names <- c("Iran","Isreal","Japan","India","North Korea","South Korea","Soviet Union","United Kingdom", "cayman Islands")

```


```{r space_race, fig.align='center', fig.height= 5, fig.width= 11}

country_names <- c(US = "United States",
                'F'  = "France",
                BR = "Brazil",
                CN = "China",
                I = "italy",      
                'I-ELDO' =  "NA",
                'I-ESA' = "European Space Agency",
                RU  = "Russia",
                IR = "Iran",
                IL = "Isreal",
                J = "Japan",
                IN = "India",
                KR = "North Korea",
                KP = "South Korea",
                SU = "North Korean Space Agency",
                UK = "United Kingdom",
                CYM = "Cayman Islands")   

launches <- launches %>% 
  mutate(country_name = country_names[state_code])

launches <- launches %>% 
  mutate(agency = case_when(is.na(agency) ~ state_code,
                            TRUE ~ agency))

space_race <- launches %>% 
  # filter(state_code %in% c("US", "SU", "RU")) %>% 
  group_by(launch_year, agency) %>% 
  summarise(state_code, num_launches = n()) %>% 
  ungroup()
  


launchs_per_year_US_SU <- space_race %>% 
  filter(state_code %in% c("US", "SU", "RU")) %>% 
  ggplot( aes(x = launch_year,
              y = num_launches))+
  geom_point(aes(color = state_code))+
  geom_line(aes(color = state_code))+
  gghighlight(state_code %in% c("US","SU","RU"))+
  theme_minimal()+
  labs(title = "United States and Soviet Union (Russia) Space Race",
       x = "",
       y = "launches/year")+
  scale_color_brewer(palette = "YIGnBu")



launchs_per_year_non_us_su <- space_race %>% 
  ggplot(aes(x = launch_year,
              y = num_launches))+
  geom_point(aes(color = state_code))+
  geom_line(aes(color = state_code))+
  gghighlight(!state_code %in% c("US","SU","RU"))+
  theme_minimal()+
  labs(title = "Countries joining Space Exploration",
       x = "",
       y = "launches/year")+
  scale_color_brewer(palette = "YIGnBu")

launchs_per_year_US_SU | launchs_per_year_non_us_su

```

```{r space_race success}


```

US Launches 

1966: Peaked state launches
1986: Challenger Explosion
1989: Private commercial Launches starts
2012: Barely any state launches

```{r}
 launches %>% 
  filter(state_code == "US") %>% 
  mutate(agency_type = ifelse(as.character(agency_type) == "startup", "private", as.character(agency_type))) %>%  # combine startup and private
  group_by(launch_year,agency_type,category) %>% 
  count() %>% 
  unite('type_category',agency_type:category,remove=FALSE) %>% 
  mutate(type_category = case_when(type_category=="state_F" ~ "State - Failure",
                                   type_category=="state_O" ~ "State - Success",
                                   type_category=="private_F" ~ "Private - Failure",
                                   type_category=="private_O" ~ "Private - Success")) %>% 
  ggplot(aes(x=launch_year,y=n,fill = type_category))+
  geom_col(width = 0.8)+
  geom_segment(aes(x = 1966, y = 85, xend = 1966, yend = 78),color = "royalblue",
                  arrow = arrow(length = unit(0.15, "cm")))+
  geom_segment(aes(x = 1986, y = 40, xend = 1986, yend = 20),color = "indianred",
                  arrow = arrow(length = unit(0.15, "cm")))+
  geom_segment(aes(x = 1988.5, y = 60, xend = 1988.5, yend = 20),color = "grey40",
                  arrow = arrow(length = unit(0.15, "cm")))+
  geom_segment(aes(x = 2012, y = 42, xend = 2012, yend = 20),color = "royalblue",
                  arrow = arrow(length = unit(0.15, "cm")))+
  annotate("text", x=1966, y=88, label= "1966: Highest State Launches",size=2.5, color="royalblue3") +
  annotate("text", x=1985, y=48, label= "1986:\n Challenger \n Explosion",size=2.5, color="indianred3") +
  annotate("text", x=1988.5, y=63, label= "1989: Private Launches Begins",size=2.5, color="grey30") +
  annotate("text", x=2012, y=45, label= "2012: State Launches Faded",size=2.5, color="royalblue3") +
  annotate("text", x=1960, y=71, label= "High failure rates \n in early years",size=2.3,color="lightblue4") +
  labs(title = "US State Launches Falls and Private Launches Rises",
       subtitle = "US State and Private Launches by Success",
       x="Year",
       y="Launches",
       fill="Agency Success")+
  theme_clean()+
  scale_fill_manual("Agency Success", 
                    values = c("State - Failure" = "lightblue", 
                               "State - Success" = "dodgerblue",
                               "Private - Failure" = "grey", 
                               "Private - Success" = "black"))+
  theme(legend.title = element_text( size=8), legend.text=element_text(size=8), legend.background = element_rect(color = NA))

```
state and private launches success/failure rate (spaceX)
NASA fails, budget cut, 
blow stuff up cheaper

