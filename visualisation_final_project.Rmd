---
title: "Data Visualisation Final Project"
author: "Study Group 11: Nereid Kwok, Nisa Ozer, Lauren Wade, Thomas Giannetti-Fakhouri, Kazmer Nagy-Betegh, Chandrime Tolia"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: flatly
    highlight: zenburn
    number_sections: true
    toc: yes
    toc_float: yes
---


```{r libraries, include=FALSE}

library(skimr)
library(vroom)
library(tidyverse)
library(dplyr)
library(ggthemes)
library(gghighlight)
library(plotly)
library(patchwork)
library(countrycode)
```


```{r}
astronauts <- vroom('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-07-14/astronauts.csv')

launches <- vroom("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-15/launches.csv")

agencies <- vroom("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-15/agencies.csv")

mission_success <- vroom(here::here("data","Space_Corrected.csv"))
```

```{r}
skim(astronauts)
```


```{r}
skim(launches)
```


```{r}
skim(agencies)
```

```{r}
mission_success <- select(mission_success, -c(1,2))

state_names <- c("Iran","Isreal","Japan","India","North Korea","South Korea","Soviet Union","United Kingdom", "cayman Islands")

```


```{r space_race, fig.align='center', fig.height= 5, fig.width= 11}

country_names <- c(US = "United States",
                'F'  = "France",
                BR = "Brazil",
                CN = "China",
                I = "italy",      
                'I-ELDO' =  "NA",
                'I-ESA' = "European Space Agency",
                RU  = "Russia",
                IR = "Iran",
                IL = "Isreal",
                J = "Japan",
                IN = "India",
                KR = "North Korea",
                KP = "South Korea",
                SU = "North Korean Space Agency",
                UK = "United Kingdom",
                CYM = "Cayman Islands")   

launches <- launches %>% 
  mutate(country_name = country_names[state_code])

launches <- launches %>% 
  mutate(agency = case_when(is.na(agency) ~ state_code,
                            TRUE ~ agency))

space_race <- launches %>% 
  # filter(state_code %in% c("US", "SU", "RU")) %>% 
  group_by(launch_year, agency) %>% 
  summarise(state_code, num_launches = n()) %>% 
  ungroup()
  


launchs_per_year_US_SU <- space_race %>% 
  filter(state_code %in% c("US", "SU", "RU")) %>% 
  ggplot( aes(x = launch_year,
              y = num_launches))+
  geom_point(aes(color = state_code))+
  geom_line(aes(color = state_code))+
  gghighlight(state_code %in% c("US","SU","RU"))+
  theme_minimal()+
  labs(title = "United States and Soviet Union (Russia) Space Race",
       x = "",
       y = "launches/year")+
  scale_color_brewer(palette = "YIGnBu")



launchs_per_year_non_us_su <- space_race %>% 
  ggplot(aes(x = launch_year,
              y = num_launches))+
  geom_point(aes(color = state_code))+
  geom_line(aes(color = state_code))+
  gghighlight(!state_code %in% c("US","SU","RU"))+
  theme_minimal()+
  labs(title = "Countries joining Space Exploration",
       x = "",
       y = "launches/year")+
  scale_color_brewer(palette = "YIGnBu")

launchs_per_year_US_SU | launchs_per_year_non_us_su

```

```{r space_race success}
age <- astronauts %>% 
  mutate(age_at_mission = year_of_mission - year_of_birth) %>% 
  select(age_at_mission, year_of_mission, year_of_birth, name) %>%
  mutate(decade = case_when((year_of_mission >= 1960 & year_of_mission < 1970) ~ "1960s",
                            (year_of_mission >= 1970 & year_of_mission < 1980) ~ "1970s",
                            (year_of_mission >= 1980 & year_of_mission < 1990) ~ "1980s",
                            (year_of_mission >= 1990 & year_of_mission < 2000) ~ "1990s",
                            (year_of_mission >= 2000 & year_of_mission < 2010) ~ "2000s",
                            (year_of_mission >= 2010 & year_of_mission < 2020) ~ "2010s"))

age_first <- age %>% 
  group_by(name) %>% 
  summarise(age_at_mission = min(age_at_mission), decade)

#age at their first mission, when they become astronauts
age_first_plot <- age_first %>% 
  ggplot(aes( x = age_at_mission, fill=decade )) +
  geom_histogram()+
  labs(title = "Astronauts Have Started Their Career Later Overtime",
       subtitle = "Age taken for each astronaut at the time of their first mission",
       x="Age at Mission",
       y="Number of Austronauts") +
  facet_wrap(~decade)+
  theme_minimal()
 
age_first_plot

#general age distribution in the industry
age_plot <- age %>% 
  ggplot(aes( x = age_at_mission, fill=decade )) +
  geom_histogram() +
  labs(title = "Astronauts Have Gotten Older Overtime",
       subtitle = "Age taken for each astronaut at time of every mission",
        x="Age at Mission",
       y="Number of Austronauts") +
  theme_minimal() +
  facet_wrap(~decade)
 
age_plot
```


```{r fig.align='center', fig.height= 5, fig.width= 11}

gender_count <- astronauts %>% 
    group_by(sex, year_of_mission) %>% 
    count(year_of_mission)

female_male <- gender_count %>% 
  ggplot(aes(x = year_of_mission, y = n, fill = sex)) +
  geom_col() +
  labs(title = "Women Start Going to Space in the 80s",
       subtitle = "Data taken for each austronaut at time of every mission",
       x="Year of Mission",
       y="Number of Austronauts")+
  theme_minimal()

female_male_annotated <- female_male + 
  annotate("text", x = 1965, y = 25, label = "Valentina Tereshkova", size = 3) + 
  annotate("segment", x = 1965, xend = 1963, y = 23,  yend = 6, colour = "black", size = 0.5 , arrow = arrow() )

female_male_annotated + scale_x_continuous(breaks=seq(1960,2020,5)) + 
  geom_text(aes(label = n), vjust = -0.2, size =4)

```

