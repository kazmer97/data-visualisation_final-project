group_by(launch_year, country_name, category) %>%
summarise(n_missions = n()) %>%
mutate(prc_missions = round(n_missions/sum(n_missions)*100,2)) %>%
ggplot(aes(x = country_name,
y = n_missions))+
geom_col(aes(fill = category))+
geom_text(aes(x = country_name,
y = n_missions,
label = paste0(prc_missions,"%"),
group = category),
position=position_stack(vjust=0.5),
size = rel(0.5))+
theme_minimal()+
labs(title = "1957 - 1969 Space Race success Rate",
x = "",
y = "launches/year",
fill = "")+
facet_grid(~launch_year)+
scale_fill_manual(label = c("Failed Mission", "Succesful Mission"),
values = c("tomato","springgreen4"))+
theme(axis.text.x = element_text(angle= 45, ))+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size),
plot.subtitle = element_text(size = subtitle.size))
space_race_mission_success
space_race_mission_success <- launches %>%
filter(state_code %in% c("US", "SU", "RU")) %>%
filter(launch_year < 1970) %>%
group_by(launch_year, country_name, category) %>%
summarise(n_missions = n()) %>%
mutate(prc_missions = round(n_missions/sum(n_missions)*100,2)) %>%
ggplot(aes(x = country_name,
y = n_missions))+
geom_col(aes(fill = category))+
geom_text(aes(x = country_name,
y = n_missions,
label = paste0(prc_missions,"%"),
group = category),
position=position_stack(vjust=0.5),
size = rel(0.9))+
theme_minimal()+
labs(title = "1957 - 1969 Space Race success Rate",
x = "",
y = "launches/year",
fill = "")+
facet_grid(~launch_year)+
scale_fill_manual(label = c("Failed Mission", "Succesful Mission"),
values = c("tomato","springgreen4"))+
theme(axis.text.x = element_text(angle= 45, ))+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size),
plot.subtitle = element_text(size = subtitle.size))
space_race_mission_success
space_race_mission_success <- launches %>%
filter(state_code %in% c("US", "SU", "RU")) %>%
filter(launch_year < 1970) %>%
group_by(launch_year, country_name, category) %>%
summarise(n_missions = n()) %>%
mutate(prc_missions = round(n_missions/sum(n_missions)*100,2)) %>%
ggplot(aes(x = country_name,
y = n_missions))+
geom_col(aes(fill = category))+
geom_text(aes(x = country_name,
y = n_missions,
label = paste0(prc_missions,"%"),
group = category),
position=position_stack(vjust=0.5),
size = rel(1))+
theme_minimal()+
labs(title = "1957 - 1969 Space Race success Rate",
x = "",
y = "launches/year",
fill = "")+
facet_grid(~launch_year)+
scale_fill_manual(label = c("Failed Mission", "Succesful Mission"),
values = c("tomato","springgreen4"))+
theme(axis.text.x = element_text(angle= 45, ))+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size),
plot.subtitle = element_text(size = subtitle.size))
space_race_mission_success
space_race_mission_success <- launches %>%
filter(state_code %in% c("US", "SU", "RU")) %>%
filter(launch_year < 1970) %>%
group_by(launch_year, country_name, category) %>%
summarise(n_missions = n()) %>%
mutate(prc_missions = round(n_missions/sum(n_missions)*100,2)) %>%
ggplot(aes(x = country_name,
y = n_missions))+
geom_col(aes(fill = category))+
geom_text(aes(x = country_name,
y = n_missions,
label = paste0(prc_missions,"%"),
group = category),
position=position_stack(vjust=0.5),
size = rel(5))+
theme_minimal()+
labs(title = "1957 - 1969 Space Race success Rate",
x = "",
y = "launches/year",
fill = "")+
facet_grid(~launch_year)+
scale_fill_manual(label = c("Failed Mission", "Succesful Mission"),
values = c("tomato","springgreen4"))+
theme(axis.text.x = element_text(angle= 45, ))+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size),
plot.subtitle = element_text(size = subtitle.size))
space_race_mission_success
space_race_mission_success <- launches %>%
filter(state_code %in% c("US", "SU", "RU")) %>%
filter(launch_year < 1970) %>%
group_by(launch_year, country_name, category) %>%
summarise(n_missions = n()) %>%
mutate(prc_missions = round(n_missions/sum(n_missions)*100,2)) %>%
ggplot(aes(x = country_name,
y = n_missions))+
geom_col(aes(fill = category))+
geom_text(aes(x = country_name,
y = n_missions,
label = paste0(prc_missions,"%"),
group = category),
position=position_stack(vjust=0.5),
size = rel(3))+
theme_minimal()+
labs(title = "1957 - 1969 Space Race success Rate",
x = "",
y = "launches/year",
fill = "")+
facet_grid(~launch_year)+
scale_fill_manual(label = c("Failed Mission", "Succesful Mission"),
values = c("tomato","springgreen4"))+
theme(axis.text.x = element_text(angle= 45, ))+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size),
plot.subtitle = element_text(size = subtitle.size))
space_race_mission_success
space_race_mission_success <- launches %>%
filter(state_code %in% c("US", "SU", "RU")) %>%
filter(launch_year < 1970) %>%
group_by(launch_year, country_name, category) %>%
summarise(n_missions = n()) %>%
mutate(prc_missions = round(n_missions/sum(n_missions)*100,2)) %>%
ggplot(aes(x = country_name,
y = n_missions))+
geom_col(aes(fill = category))+
geom_text(aes(x = country_name,
y = n_missions,
label = paste0(prc_missions,"%"),
group = category),
position=position_stack(vjust=0.5),
size = rel(2))+
theme_minimal()+
labs(title = "1957 - 1969 Space Race success Rate",
x = "",
y = "launches/year",
fill = "")+
facet_grid(~launch_year)+
scale_fill_manual(label = c("Failed Mission", "Succesful Mission"),
values = c("tomato","springgreen4"))+
theme(axis.text.x = element_text(angle= 45, ))+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size),
plot.subtitle = element_text(size = subtitle.size))
space_race_mission_success
space_race_mission_success <- launches %>%
filter(state_code %in% c("US", "SU", "RU")) %>%
filter(launch_year < 1970) %>%
group_by(launch_year, country_name, category) %>%
summarise(n_missions = n()) %>%
mutate(prc_missions = round(n_missions/sum(n_missions)*100,2)) %>%
ggplot(aes(x = country_name,
y = n_missions))+
geom_col(aes(fill = category))+
geom_text(aes(x = country_name,
y = n_missions,
label = paste0(prc_missions,"%"),
group = category),
position=position_stack(vjust=0.5),
size = rel(3))+
theme_minimal()+
labs(title = "1957 - 1969 Space Race success Rate",
x = "",
y = "launches/year",
fill = "")+
facet_grid(~launch_year)+
scale_fill_manual(label = c("Failed Mission", "Succesful Mission"),
values = c("tomato","springgreen4"))+
theme(axis.text.x = element_text(angle= 45, ))+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size),
plot.subtitle = element_text(size = subtitle.size))
space_race_mission_success
gender_count <- astronauts %>%
group_by(sex, year_of_mission) %>%
count(year_of_mission)
female_male <- gender_count %>%
ggplot(aes(x = year_of_mission, y = n, fill = sex)) +
geom_col() +
labs(title = "Women Start Going to Space in the 80s",
subtitle = "Data taken for each austronaut at time of every mission",
x="Year of Mission",
y="Number of Austronauts")+
theme_minimal()
female_male_annotated <- female_male +
annotate("text", x = 1965, y = 25, label = "Valentina Tereshkova", size = 3) +
annotate("segment", x = 1965, xend = 1963, y = 23,  yend = 6, colour = "black", size = 0.5 , arrow = arrow() )
female_male_annotated + scale_x_continuous(breaks=seq(1960,2020,5)) +
geom_text(aes(label = n), vjust = -0.2, size =4)+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size),
plot.subtitle = element_text(size = subtitle.size))
gender_count <- astronauts %>%
group_by(sex, year_of_mission) %>%
count(year_of_mission)
female_male <- gender_count %>%
ggplot(aes(x = year_of_mission, y = n, fill = sex)) +
geom_col() +
labs(title = "Women Start Going to Space in the 80s",
subtitle = "Data taken for each austronaut at time of every mission",
x="Year of Mission",
y="Number of Austronauts")+
theme_minimal()
female_male_annotated <- female_male +
annotate("text", x = 1965, y = 25, label = "Valentina Tereshkova", size = 3) +
annotate("segment", x = 1965, xend = 1963, y = 23,  yend = 6, colour = "black", size = 0.5 , arrow = arrow() )
female_male_annotated +
scale_x_continuous(breaks=seq(1960,2020,5)) +
geom_text(aes(label = n),
position=position_stack(vjust=0.5),
size =4)+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size),
plot.subtitle = element_text(size = subtitle.size))
unlink("visualisation_final_project_cache", recursive = TRUE)
library(flexdashboard)
img <- readJPEG(here::here("data/milky.jpg"))
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE,
results = FALSE,
knitr::opts_knit$set(root.dir = getwd())
)
title.size <- 16
subtitle.size <- 12
axis.title.size <- 10
axis.text.size <- 8
library(flexdashboard)
library(bslib)
library(skimr)
library(vroom)
library(tidyverse)
library(dplyr)
library(ggthemes)
library(gghighlight)
library(plotly)
library(patchwork)
library(countrycode)
library(jpeg)
library(png)
library(grid)
library(svglite)
astronauts <- vroom('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-07-14/astronauts.csv')
launches <- vroom("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-15/launches.csv")
agencies <- vroom("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-01-15/agencies.csv")
mission_success <- vroom(here::here("data","Space_Corrected.csv"))
mission_success <- select(mission_success, -c(1,2))
mission_success <- mission_success %>%
janitor::clean_names() %>%
mutate(datum = as.Date(mission_success$Datum, format = "%a %b %d, %Y"))
launches <-  launches %>%
left_join(mission_success, by = c("launch_date" = "datum"))
country_names <- c(US = "United States",
'F'  = "France",
BR = "Brazil",
CN = "China",
I = "italy",
'I-ESA' = "European Space Agency",
RU  = "Russia",
IR = "Iran",
IL = "Isreal",
J = "Japan",
IN = "India",
KR = "North Korea",
KP = "South Korea",
SU = "Soviet Union",
UK = "United Kingdom",
CYM = "Cayman Islands",
'I-ELDO' = "European Launcher Development Organisation")
country_colors <- c(US = "blue",
'F'  = "skyblue",
BR = "limegreen",
CN = "red3",
I = "lightgreen",
'I-ESA' = "plum1",
RU  = "tomato",
IR = "lightgoldenrod",
IL = "tan2",
J = "mistyrose",
IN = "",
KR = "North Korea",
KP = "South Korea",
SU = "Soviet Union",
UK = "United Kingdom",
CYM = "Cayman Islands",
'I-ELDO' = "European Launcher Development Organisation")
launches <- launches %>%
mutate(country_name = country_names[state_code])
launches <- launches %>%
mutate(agency = case_when(is.na(agency) ~ state_code,
TRUE ~ agency))
launches %>%
filter(country_name == "NA")
space_race <- launches %>%
# filter(state_code %in% c("US", "SU", "RU")) %>%
group_by(launch_year, country_name) %>%
summarise(state_code, country_name, num_launches = n()) %>%
ungroup()
launchs_per_year_US_SU <- space_race %>%
filter(state_code %in% c("US", "SU", "RU")) %>%
ggplot( aes(x = launch_year,
y = num_launches))+
geom_point(aes(color = country_name))+
geom_line(aes(color = country_name))+
gghighlight(state_code %in% c("US","SU","RU"))+
theme_minimal()+
labs(title = "United States and Soviet Union (Russia) Space Race",
x = "",
y = "launches/year")
# scale_color_manual(values = country_colors)
launchs_per_year_non_us_su <- space_race %>%
ggplot(aes(x = launch_year,
y = num_launches))+
geom_point(aes(color = country_name))+
geom_line(aes(color = country_name))+
gghighlight(!state_code %in% c("US","SU","RU"))+
theme_minimal()+
labs(title = "Countries joining Space Exploration",
x = "",
y = "launches/year")
# scale_color_manual(values = country_colors)
temp <- launchs_per_year_US_SU  | launchs_per_year_non_us_su
ggsave("figures/launches_per_country.svg", temp, height = 10, width = 12)
img <- readJPEG(here::here("data/milky.jpg"))
g <- rasterGrob(img, interpolate=TRUE)
space_race_dates <- space_race %>%
filter(state_code %in% c("US", "SU", "RU")) %>%
ggplot( aes(x = launch_year,
y = num_launches))+
geom_point(aes(color = country_name))+
geom_line(aes(color = country_name))+
gghighlight(state_code %in% c("US","SU","RU"))+
theme_minimal()+
labs(title = "1957 - 1969 Space Race",
x = "",
y = "launches/year")+
annotate("rect", xmin = 1957, xmax = 1969, ymin = 0, ymax = 110,
alpha = 0.3, fill = "skyblue")+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size))
# space_race_dates
ggsave(file="/space_race_dates.svg", plot=space_race_dates, width=12, height=3)
img <- readJPEG(here::here("data/milky.jpg"))
g <- rasterGrob(img, interpolate=TRUE)
space_race_dates <- space_race %>%
filter(state_code %in% c("US", "SU", "RU")) %>%
ggplot( aes(x = launch_year,
y = num_launches))+
geom_point(aes(color = country_name))+
geom_line(aes(color = country_name))+
gghighlight(state_code %in% c("US","SU","RU"))+
theme_minimal()+
labs(title = "1957 - 1969 Space Race",
x = "",
y = "launches/year")+
annotate("rect", xmin = 1957, xmax = 1969, ymin = 0, ymax = 110,
alpha = 0.3, fill = "skyblue")+
theme(plot.title = element_text(size = title.size),
axis.title = element_text(size = axis.title.size),
axis.text = element_text(size = axis.text.size))
# space_race_dates
ggsave(file="figures/space_race_dates.svg", plot=space_race_dates, width=12, height=3)
unlink("visualisation_final_project_cache", recursive = TRUE)
space_walk <- astronauts %>%
group_by(name) %>%
distinct(nationality, total_eva_hrs) %>%
ungroup() %>%
slice_max(order_by = total_eva_hrs, n=15, with_ties = TRUE) %>%
ggplot()+
geom_col(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
fill = nationality))+
geom_text(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
label = total_eva_hrs),
hjust = 2)+
theme_minimal()+
labs(title = "Most Hours Spent Space Walking",
y = "",
x = "hours")+
scale_color_manual(values = c("blue", "tomato"))
ggsave("figures/space_walk.svg", space_walk, width = 12, height = 10)
space_walk <- astronauts %>%
group_by(name) %>%
distinct(nationality, total_eva_hrs) %>%
ungroup() %>%
slice_max(order_by = total_eva_hrs, n=15, with_ties = TRUE) %>%
ggplot()+
geom_col(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
fill = nationality))+
geom_text(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
label = total_eva_hrs),
hjust = 2)+
theme_minimal()+
labs(title = "Most Hours Spent Space Walking",
y = "",
x = "hours")+
scale_color_manual(values = c("tomato", "blue"))
ggsave("figures/space_walk.svg", space_walk, width = 12, height = 10)
?scale_color_manual
space_walk
space_walk
space_walk
space_walk <- astronauts %>%
group_by(name) %>%
distinct(nationality, total_eva_hrs) %>%
ungroup() %>%
slice_max(order_by = total_eva_hrs, n=15, with_ties = TRUE) %>%
ggplot()+
geom_col(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
fill = nationality))+
geom_text(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
label = total_eva_hrs),
hjust = 2)+
theme_minimal()+
labs(title = "Most Hours Spent Space Walking",
y = "",
x = "hours")+
scale_color_manual(values = c("tomato", "blue"))
space_walk
space_walk <- astronauts %>%
group_by(name) %>%
distinct(nationality, total_eva_hrs) %>%
ungroup() %>%
slice_max(order_by = total_eva_hrs, n=15, with_ties = TRUE) %>%
ggplot()+
geom_col(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
fill = nationality))+
geom_text(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
label = total_eva_hrs),
hjust = 2)+
theme_minimal()+
labs(title = "Most Hours Spent Space Walking",
y = "",
x = "hours")+
scale_color_manual(values = c( "blue", "tomato"))
space_walk
space_walk <- astronauts %>%
group_by(name) %>%
distinct(nationality, total_eva_hrs) %>%
ungroup() %>%
slice_max(order_by = total_eva_hrs, n=15, with_ties = TRUE) %>%
ggplot()+
geom_col(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
fill = nationality))+
geom_text(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
label = total_eva_hrs),
hjust = 2)+
theme_minimal()+
labs(title = "Most Hours Spent Space Walking",
y = "",
x = "hours")+
scale_fill_manual(values = c( "blue", "tomato"))
space_walk
space_walk <- astronauts %>%
group_by(name) %>%
distinct(nationality, total_eva_hrs) %>%
ungroup() %>%
slice_max(order_by = total_eva_hrs, n=15, with_ties = TRUE) %>%
ggplot()+
geom_col(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
fill = nationality))+
geom_text(aes(x = total_eva_hrs,
y = reorder(name,total_eva_hrs),
label = total_eva_hrs),
hjust = 2)+
theme_minimal()+
labs(title = "Most Hours Spent Space Walking",
y = "",
x = "hours")+
scale_fill_manual(values = c( "lightblue", "tomato"))
space_walk
